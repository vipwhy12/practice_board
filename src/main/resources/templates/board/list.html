<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>boardList</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/static/icons/fontawesome/all.js"></script>
    <script>
        $(document).ready(function (){
            const SHOW_PAGE = 5;

            const memberName = "[[${session.memberName}]]";
            let totalPage = "[[${totalPage}]]";
            let first = 0;
            let last = 0;
            let page =  Number(totalPage) / SHOW_PAGE;

            //세션에 객체가 담겼을 때
            if(memberName.length !== 0){
                $(".insert-board").css('display', 'block');
                $(document).on('click', '.insert-board', function (){
                    location.href = 'write';
                })
            }else{
               $(".insert-board").css('display', 'none')
            }

            if(totalPage <= SHOW_PAGE){
                for(let i = 0; i < totalPage ; i++){
                    $(".prev").after("<a href='/board/list?page=i'>i</a>")
                }
            }else {
                if(totalPage % SHOW_PAGE !== 0){
                    page += 1;
                }
                for(let i = 0; i <= SHOW_PAGE ; i++){
                    $(".prev").append("<a href='/board/list?page="+ page + "'><span>" + i +"</span></a>");
                }
            }

        });

        $(function (){
            const totalPage = '[[${totalPage}]]';
            let page = 0;
            //prev 버튼이 눌렸을때
            $('.prev').on("click", function (){

            })

            $('.next').on("click", function (){

            })
        });


    </script>
</head>
<body>
    <h1> Welcome to Board </h1>
    <table>
        <thead>
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>작성자</th>
                <th>작성일</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="board : ${boardList}">
                <td><span th:text="${boardStat.count} + ${offset}  "></span></td>
                <td><a th:text="${board.title}" th:href="@{/board/{no}(no = ${board.no})}"></a></td>
                <td th:text="${board.member.name}"></td>
                <td th:text="${board.time}"></td>
            </tr>
        </tbody>
    </table>

    <div class="pagination">
        <a class="prev" href="/board/list">
            <i class="fa fa-chevron-circle-left" aria-hidden="true"></i>
        </a>
        <a class="next" th:href="@{/board/list(page=${page},totalPage=${totalPage})}">
            <i class="fa fa-chevron-circle-right" aria-hidden="true"></i>
        </a>
    </div>



    <th:block th:each="page : ${#numbers.sequence(1,totalPage)}" >
        <a th:text="${page}" th:href="@{/board/list(page=${page},totalPage=${totalPage})}"></a>
    </th:block>



    <div class="insert-board">
        <button>새로운 글 작성하기</button>
    </div>

    <script src="https://kit.fontawesome.com/6478f529f2.js" crossorigin="anonymous"></script>
</body>
</html>